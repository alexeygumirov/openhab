import org.openhab.model.script.actions.Timer

var Timer InitDelayTimer = null

rule "Initialize presence to OFF"
when
   System started
then

   var String LogTopic = "init.rules"

   SecMessage.postUpdate("Сообщений нет.")

   InitDelayTimer = createTimer(now.plusSeconds(30)) [|
       if ( Pers2Smart2.state == OPEN ) {
           Pers2_OwnTracks_Close.postUpdate(ON)
     	   Pers2_OwnTracks_FarAway.postUpdate(OFF)
           logInfo(LogTopic, "INITIALIZING GEO PRESENCE: FAR AWAY: The item " + Pers2_OwnTracks_FarAway.name + " changed state to " + Pers2_OwnTracks_FarAway.state.toString )
           logInfo(LogTopic, "INITIALIZING GEO PRESENCE: CLOSE: The item " + Pers2_OwnTracks_Close.name + " changed state to " + Pers2_OwnTracks_Close.state.toString )
	   } 

       if ( Pers1Smart1.state == OPEN ) {
           Pers1_OwnTracks_Close.postUpdate(ON)
           Pers1_OwnTracks_FarAway.postUpdate(OFF)
           logInfo(LogTopic, "INITIALIZING GEO PRESENCE: FAR AWAY: The item " + Pers1_OwnTracks_FarAway.name + " changed state to " + Pers1_OwnTracks_FarAway.state.toString )
           logInfo(LogTopic, "INITIALIZING GEO PRESENCE: CLOSE: The item " + Pers1_OwnTracks_Close.name + " changed state to " + Pers1_OwnTracks_Close.state.toString )
       } 
       
	   InitDelayTimer = null
   ]

end
